{% extends "base.html" %}
{% load math_extras %}

{% block content %}
<style>
    /* Styles specific to summary.html, complementing base.html */
    .summary-page-container {
        padding-top: 40px;
        padding-bottom: 60px;
    }

    .summary-page-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 2.5rem;
        text-align: center;
    }

    /* Key Metric Cards */
    .metric-card {
        border-radius: var(--border-radius-lg);
        color: white;
        padding: 2rem 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: var(--shadow-medium);
        transition: transform 0.2s ease-in-out;
    }
    .metric-card:hover {
        transform: translateY(-5px);
    }

    .metric-card h5 { /* Metric Title */
        font-size: 1.1rem;
        font-weight: 500;
        margin-bottom: 0.75rem;
        opacity: 0.9;
        color: white;
    }
    .metric-card h2 { /* Metric Value */
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 0;
        color: white;
    }

    .bg-metric-income { background: linear-gradient(135deg, var(--success-color), #238C3F); } /* Darker green */
    .bg-metric-expense { background: linear-gradient(135deg, var(--danger-color), #B82B39); } /* Darker red */
    .bg-metric-cashflow { background: linear-gradient(135deg, var(--secondary-color), var(--primary-color)); } /* Teal to Blue */


    /* Insights Card */
    .insights-card {
        border-radius: var(--border-radius-lg);
        box-shadow: var(--shadow-soft);
        background-color: var(--bg-card);
    }
    .insights-card .card-header {
        background-color: transparent;
        border-bottom: 1px solid var(--border-color);
        padding: 1.5rem;
    }
    .insights-card .card-header h5 {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--primary-color);
        margin: 0;
        display: flex;
        align-items: center;
    }
    .insights-card .card-header i {
        margin-right: 0.75rem;
        color: var(--accent-color); /* Gold icon */
    }

    .insights-content {
        padding: 1.5rem 2rem; /* More padding for readability */
        line-height: 1.8;
        font-size: 1.05rem; /* Slightly larger for content */
        color: var(--text-secondary);
        white-space: pre-line; /* Preserve line breaks from template */
    }

    .insights-content h2, .insights-content h3 { /* Headings within insights */
        color: var(--text-primary);
        margin-top: 1.5rem;
        margin-bottom: 1rem;
        font-weight: 600;
    }
    .insights-content h2 { font-size: 1.4rem; }
    .insights-content h3 { font-size: 1.2rem; }

    .insights-content ul, .insights-content ol {
        padding-left: 1.5rem; /* Indent lists */
        margin-bottom: 1rem;
    }
    .insights-content li {
        margin-bottom: 0.5rem;
    }
    .insights-content strong {
        font-weight: 600;
        color: var(--text-primary);
    }
    .insights-content code { /* If you use code blocks for anything */
        background-color: #f0f0f0;
        padding: 0.2em 0.4em;
        border-radius: var(--border-radius-sm);
        font-size: 0.9em;
    }

    .insights-actions {
        padding: 1.5rem 2rem;
        border-top: 1px solid var(--border-color);
        background-color: #FDFDFD; /* Slightly off-white footer */
        border-bottom-left-radius: var(--border-radius-lg);
        border-bottom-right-radius: var(--border-radius-lg);
    }
    .insights-actions .btn {
        margin-right: 0.75rem;
        font-weight: 500;
    }
    .insights-actions .btn i {
        margin-right: 0.5rem;
    }
    .insights-actions .btn-primary {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
    }
    .insights-actions .btn-primary:hover {
        background-color: var(--primary-hover);
        border-color: var(--primary-hover);
    }
    .insights-actions .btn-success { /* For action items */
        background-color: var(--accent-color); /* Gold for CTA */
        border-color: var(--accent-color);
        color: var(--text-primary); /* Dark text on gold */
    }
    .insights-actions .btn-success:hover {
        background-color: #DDA200; /* Darker gold */
        border-color: #DDA200;
    }

</style>

<div class="container summary-page-container">
    <h1 class="summary-page-title">Actionable Financial Insights</h1>

    <div class="row mt-4 mb-5">
        <div class="col-md-4">
            <div class="metric-card bg-metric-income">
                <h5>30-Day Income</h5>
                <h2>₹{{ total_income|default:0|floatformat:2 }}</h2>
            </div>
        </div>
        <div class="col-md-4">
            <div class="metric-card bg-metric-expense">
                <h5>30-Day Expenses</h5>
                <h2>₹{{ total_expenses|default:0|floatformat:2 }}</h2>
            </div>
        </div>
        <div class="col-md-4">
            <div class="metric-card bg-metric-cashflow">
                <h5>Net Cash Flow (30-Day)</h5>
                <h2>₹{{ total_income|subtract:total_expenses|default:0|floatformat:2 }}</h2>
            </div>
        </div>
    </div>

    <div class="card insights-card shadow mb-4">
        <div class="card-header">
            <h5>
                <i class="fas fa-lightbulb"></i> AI-Generated Action Plan
            </h5>
        </div>
        <div class="card-body insights-content">
            {{ insights|default:"No insights available at the moment. Please check back later or ensure your financial data is up to date." }}
        </div>

        <div class="insights-actions">
            <button class="btn btn-primary">
                <i class="fas fa-download"></i> Export as PDF
            </button>
            <button class="btn btn-success">
                <i class="fas fa-tasks"></i> Create Action Items
            </button>
        </div>
    </div>
</div>
{% endblock %}